!function(d){"use strict";var b={init:function(){this.showNotifications(),this.switchNotices(),this.dismissNotice()},showNotifications:function(){d(document).on("click","#bb-notifications-button",function(s){s.preventDefault(),d(this).closest(".bb-notifications-wrapepr").toggleClass("expanded"),b.checkNoticesCount()}),d(document).on("click",".close-panel-header",function(s){s.preventDefault(),d(this).closest(".bb-notifications-wrapepr").removeClass("expanded")})},switchNotices:function(){d(document).on("click",".panel-nav-list .switch-notices",function(s){s.preventDefault();var s=d(this),i=s.data("status"),n=s.closest(".bb-notifications-panel");s.closest("li").siblings().find(".switch-notices").removeClass("active"),s.addClass("active"),n.removeClass("all dismissed unread"),n.addClass(i),b.checkNoticesStatus(i)}),d(document).on("click",".panel-nav-dismiss-all",function(s){s.preventDefault();var i=d(this),n=d(".count-active"),s=n.text().trim().match(/\d+/),t=(s&&parseInt(s[0],10),d(".bb-notice-count")),e=d("#bb_in_plugin_admin_menu_unread_count"),o=i.closest(".bb-panel-nav").find(".panel-nav-list li > a.active").data("status"),s={action:"buddyboss_in_plugin_notification_dismiss",nonce:BBInPluginAdminNotifications.nonce,id:"all"};i.prop("disabled","disabled"),d.post(BBInPluginAdminNotifications.ajax_url,s,function(s){s.success?(i.closest(".bb-notifications-panel").find(".bb-notices-blocks-container .bb-notice-block").each(function(){d(this).removeClass("unread").addClass("dismissed")}),n.hide(),i.closest(".panel-nav-check").hide(),t.hide(),e.closest(".awaiting-mod").remove(),b.checkNoticesStatus(o)):console.log(s)}).fail(function(){alert("Messages could not be dismissed.")})}),b.checkNoticesStatus()},dismissNotice:function(){d(document).on("click",".bb-dismiss-notice",function(s){s.preventDefault();var s=d(this),i=s.closest(".bb-notice-block").data("message-id"),n=d("#bb-notifications-message-"+i),t=d(".count-active"),e=t.text().trim().match(/\d+/),o=e?parseInt(e[0],10):0,c=d(".bb-notice-count"),a=d("#bb_in_plugin_admin_menu_unread_count"),l=s.closest(".bb-notifications-panel").find(".panel-nav-list li > a.active").data("status"),e={action:"buddyboss_in_plugin_notification_dismiss",nonce:BBInPluginAdminNotifications.nonce,id:i};s.prop("disabled","disabled"),n.removeClass("unread").addClass("dismissed"),d.post(BBInPluginAdminNotifications.ajax_url,e,function(s){s.success?(--o<0?(o=0,t.hide(),c.hide(),a.closest(".awaiting-mod").remove()):0===o?(t.hide(),d(".buddyboss-notifications-none").show(),d(".dismiss-all").hide(),c.hide(),a.closest(".awaiting-mod").remove()):(o<10&&t.addClass("single-digit"),t.html("("+o+")"),c.html(o),a.html(o)),b.checkNoticesStatus(l)):console.log(s)}).fail(function(){alert("Message could not be dismissed.")})})},checkNoticesStatus:function(s){s=_.isUndefined(s)?"all":s;var i=d(".bb-notices-blocks-container"),n=i.find(".bb-notice-block"),t=[],e=(n.each(function(){"all"===s||d(this).hasClass(s)?t.push(!0):t.push(!1)}),0<t.length&&t.includes(!0)?(i.removeClass("bp-hide"),i.closest(".bb-panel-body").find(".bb-notices-blocks-blank").hide(),i.closest(".bb-panel-body").removeClass("empty")):(i.closest(".bb-panel-body").find(".bb-notices-blocks-blank").show(),i.closest(".bb-panel-body").addClass("empty"),i.addClass("bp-hide")),!0);n.each(function(){if(!d(this).hasClass(s))return e=!1}),e?i.closest(".bb-panel-body").addClass("all-dismissed"):i.closest(".bb-panel-body").removeClass("all-dismissed")},checkNoticesCount:function(){var s=d(".bb-notices-blocks-container").find(".bb-notice-block"),i=d("#show-active .count-unread"),n=0;0===s.length?n=0:s.each(function(){d(this).hasClass("unread")&&n++}),i.text("("+n+")")}};window.BuddyBossNoticeSystem=b,d(document).on("ready",function(){b.init()})}(jQuery);