!function(e){e(".visibility-toggle-link").on("click",function(t){t.preventDefault(),e(this).attr("aria-expanded","true").parent().hide().siblings(".field-visibility-settings").show()}),e(".field-visibility-settings-close").on("click",function(t){t.preventDefault(),e(".visibility-toggle-link").attr("aria-expanded","false");var i=e(this).parent(),a=i.find("input:checked").parent().text();i.hide().siblings(".field-visibility-settings-toggle").children(".current-visibility-level").text(a).end().show()}),e(".bb_admin_repeater_group").length>0&&(e(".bb_admin_repeater_group").each(function(){var t=e(this),i=t.attr("id").split("-").pop(),a=t.find(".repeater_group_outer").length;if(a>0){var r=[];t.find(".repeater_group_outer").each(function(){var t=e(this);r.push(t.data("set_no")),a>1&&t.find(".repeater_group_inner").hide();var i="";t.find(".editfield").each(function(){var t=e(this).find("input[type=text], input[type=number], input[type=email], input[type=phone], input:checked, textarea, select"),a=t.val(),r=t.attr("name"),n=(r?r.split("_"):"").indexOf("visibility")>-1;if(""!==e.trim(a)&&!n)return t.is("select")?(i=e.trim(t.find("option:selected").text()),!1):(i=e.trim(a),!1)}),""===i?t.find(".repeater_set_title").addClass("repeater_set_title_empty").html(BB_Member_Admin.empty_field):t.find(".repeater_set_title").html(i)}),t.append('<input type="hidden" name="repeater_set_sequence['+i+']" value="'+r.join(",")+'">'),t.find(".repeater_sets_sortable").sortable({items:".repeater_group_outer",update:function(){var a=[];e(this).find(".repeater_group_outer").each(function(){a.push(e(this).data("set_no"))}),t.find('[name="repeater_set_sequence['+i+']"]').val(a.join(","))}})}}),e(".bb_admin_repeater_group").on("click",".repeater_group_outer .repeater_set_edit",function(t){t.preventDefault(),e(this).closest(".repeater_group_outer").find(".repeater_group_inner").slideToggle(),e(this).parents(".repeater_group_outer").toggleClass("active")}),e(".bb_admin_repeater_group").on("click",".repeater_group_outer .repeater_set_delete",function(t){var i=e(this),a=e(this).parents(".bb_admin_repeater_group").attr("id"),r=e("#"+a).find("#group").val();if(t.preventDefault(),!i.hasClass("disabled")){var n=[],s="";if(e("#"+a+' [name="deleted_field_ids['+r+']"]').length&&(s=e("#"+a+' [name="deleted_field_ids['+r+']"]').val(),n.push(s)),confirm(BB_Member_Admin.confirm_delete_set)){i.closest(".repeater_group_outer").find(".editfield").each(function(){var t=e(this),i=t.find("input,textarea,select").attr("name");void 0!==(i=void 0!==i?i:t.find("textarea.wp-editor-area").attr("name"))&&(i=(i=(i=i.replace("field_","")).replace("_day","")).replace("[]",""),n.push(i))}),i.closest(".repeater_group_outer").remove();var d=[];e("#"+a+" .repeater_group_outer").each(function(){d.push(e(this).data("set_no"))}),e("#"+a+' [name="repeater_set_sequence['+r+']"]').val(d.join(","));for(var l=e("#"+a+' [name="field_ids['+r+']"]').val().split(","),p=[],o=l.length,u=n.length,f=0;f<o;f++){for(var c=!1,g=0;g<u;g++)if(l[f]===n[g]){c=!0;break}c||p.push(l[f])}p=p.join(","),e("#"+a+' [name="field_ids['+r+']"]').val(p),e("#"+a+' [name="deleted_field_ids['+r+']"]').length||e("#"+a).append('<input type="hidden" name="deleted_field_ids['+r+']" >'),e("#"+a+' [name="deleted_field_ids['+r+']"]').val(n.join(",")),e("#"+a+" .repeater_group_outer").length}}}),e(".bb_admin_repeater_group #btn_add_repeater_set").click(function(t){t.preventDefault();var i=e(this),a=i.data("group"),r=e("#profile-edit-form-"+a);!i.hasClass("disabled")&&(i.addClass("disabled"),i.attr("disabled","disabled"),i.css("pointer-events","none"),e.ajax({url:ajaxurl,method:"POST",data:{action:"bb_admin_xprofile_add_repeater_set",_wpnonce:i.data("nonce"),group:a,user_id:e("#user_id").val(),set_no:r.find('input[name="repeater_set_sequence['+a+']"]').val(),existing_field_ids:r.find('input[name="field_ids['+a+']"]').val(),deleted_field_ids:r.find('input[name="deleted_field_ids['+a+']"]').val()},success:function(e){if(e.success&&e.data){r.find(".repeater_group_outer").length?r.find(".repeater_group_outer").last().after(e.data.html):r.find(".repeater_sets_sortable").html(e.data.html),r.find('[name="field_ids['+a+']"]').val(e.data.field_ids.join(",")),r.find('[name="repeater_set_sequence['+a+']"]').val(e.data.set_no.join(",")),r.find(".repeater_sets_sortable").sortable("destroy").sortable(),r.find(".repeater_group_outer").last().addClass("active"),r.find(".repeater_group_outer .repeater_group_inner:last").show(),i.removeClass("disabled"),i.removeAttr("disabled","disabled"),i.css("pointer-events","initial");var t=jQuery(e.data.set_no).get(-1);jQuery("#profile-edit-form-"+a+" .repeater_group_outer[data-set_no="+t+"] .field_type_textarea textarea").each(function(){tinymce.EditorManager.execCommand("mceAddEditor",!1,jQuery(this).attr("name")),"undefined"!=typeof quicktags&&quicktags({id:jQuery(this).attr("name")})})}}}))}),e(".field-visibility-settings").addClass("bp-hide"),e(".visibility-toggle-link").attr("aria-expanded","false"),e(".bb_admin_repeater_group").on("click",".repeater_group_outer .visibility-toggle-link",function(t){t.preventDefault(),e(this).attr("aria-expanded","true"),e(this).parent().addClass("field-visibility-settings-hide bp-hide").siblings(".field-visibility-settings").removeClass("bp-hide").addClass("field-visibility-settings-open")}),e(".bb_admin_repeater_group").on("click",".repeater_group_outer .field-visibility-settings-close",function(t){t.preventDefault();var i=e(this).parent(),a=e(".iradio_minimal").length>0?i.find("input:checked").parent().next(".field-visibility-text").text():i.find("input:checked").parent().text();i.removeClass("field-visibility-settings-open").addClass("bp-hide").siblings(".field-visibility-settings-toggle").find(".current-visibility-level").text(a).closest(".field-visibility-settings-toggle").addClass("bp-show").removeClass("field-visibility-settings-hide bp-hide"),e(".visibility-toggle-link").attr("aria-expanded","false")})),window.clear=function(t){t&&(e("#"+(t=t.replace("[","\\[").replace("]","\\]"))+" option").length?e.each(e("#"+t+" option"),function(t,i){e(i).prop("selected",!1)}):e("#"+t+" [type=radio]").length&&e.each(e("#"+t+" [type=radio]"),function(t,i){e(i).prop("checked",!1)}))}}(jQuery);function clear(e){if(e=document.getElementById(e)){var t=e.getElementsByTagName("INPUT"),i=e.getElementsByTagName("OPTION"),a=0,r=t.length,n=i.length;if(t)for(a=0;a<r;a++)t[a].checked="";if(i)for(a=0;a<n;a++)i[a].selected=!1}}